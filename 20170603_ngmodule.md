# How does NgModule works in Angular

The first time I saw the NgModule decorator and its arguments I was completely lost. 
I couldn't understand what was the meaning of imports, declarations, exports, providers or bootstrap and I had a hard time finding clear explanations. 
So today I will go through each attributes and provide an explanation together with an example to understand what is the role of each NgModule argument.

```
1. How does a NgModule declaration look like?
2. Imports
3. Exports
4. Declarations
5. Providers
```

# 1. How does a NgModule declaration look like?

Angular utilises the typescript decorators to define `NgModule`.
It accepts `imports`, `declarations`, `exports` and `providers`.

A typical declaration would look like that:

```
import { CommonModule } from '@angular/common';
import { NgModule } from '@angular/core';

import { SquareComponent } from './square.component';
import { SquareService } from './square.service';

@NgModule({
  imports: [
    CommonModule
  ],
  declarations: [
    SquareComponent
  ],
  exports: [
    SquareComponent
  ],
  providers: [
    SquareService
  ]
})
export class SquareModule { }
```

Here we are __importing__ the `CommonModule` from `@angular/common` to give access to common directives like `ngIf` or `ngFor`.
Then we are __declaring__ the `SquareComponent` which is a component defined by ourselves.
Then we are __exporting__ it, so that other modules who import `SquareModule` can use the `SquareComponent`.
Lastly we are __providing__ a service, `SquareService` which we have defined ourselves and make it avaible for dependency injection. 

# 2. Imports

`Imports` in NgModule is an array of module. Use it to import functionalities which other modules export.

# 3. Exports

`Exports` is an array of functionalities which the module exports.
A module can also re-export an entire loaded module which then export all the functionality of that module.

For example here in (1) we imported `CommonModule`. Now let say we had a `SharedModule` with common functionalities like so:

```
import { CommonModule } from '@angular/common';
import { NgModule } from '@angular/core';

import { HighlightDirective } from './highlight.directive';

@NgModule({
  imports: [
    CommonModule
  ],
  declarations: [
    HighlightDirective
  ],
  exports: [
    HighlightDirective,
    CommonModule
  ]
})
export class SharedModule { }
```

Notice that we are exporting the `CommonModule`. By doing that, whoever is importing `SharedModule` will not need to import `CommonModule` as it will be imported thanks to `SharedModule`.

So we can change (1) to the following:

```
@NgModule({
  imports: [
    SharedModule
  ],
  declarations: [
    SquareComponent
  ],
  exports: [
    SquareComponent
  ],
  providers: [
    SquareService
  ]
})
export class SquareModule { }
```

This technique can be used to import & export multiple modules which are repeatedly imported in different modules.
It is also possible to re-export specific components, directives or pipes from imported module. This could be useful if you do not wish to re-export the whole functionalities of a module.

# 4. Declarations

`Declarations` is an array of either __components__, __directives__ or __pipes__.
They are classes defined in the module. They need to be `declared` to be usable within the module itself.

For example here we have defined `SquareComponent` in `SquareModule` and `HighlightDirective` in `SharedModule`.

Do not declare modules or services in the declarations.

# 5. Providers

`Providers` are used to provide services or connstants via dependecy injection.

_For dependency injection, more can be found in the [official documentation](https://angular.io/docs/ts/latest/guide/dependency-injection.html#!#register-providers-ngmodule)._

In this example, we have defined a service which can be injected.

```
import { Injectable } from '@angular/core';

@Injectable
export class SquareService {
  computeSurface = (side: number) => side * side;
}
```

Which we then register in the providers.

```
providers: [
    SquareService
]
```

This is a shortform the following registration `{ provide: SquareService, useClass: SquareService }`.