# Logging in ASP NET Core with Serilog

At each stages of the development cycle, good logs are necessary to debug and fix bugs efficiently.
Serilog is a logging framework which allows to log structured logs into different platforms called sinks.
Today we will see how we can set it up in three parts

```
1. Serilog for ASP.NET Core
2. Http and Rolling Files sinks
3. Live logs with server-sent events
```

## 1. Serilog for ASP.NET Core

Serilog is a logging framework providing facilities to write structured logs into different platforms called sinks.

__Structured logs__

Logs are string messages describing an event in the system. To build log messages, we assemble pieces of information like elapsed time or process name and arrange it into a string which we then write to an ouput stream, console or file for example.
The end data available is the timestamp of the log and the log message. Using this log message, all we can do to query is a full text search query.
If our log contained an elasped time counter, it would not be easy to run a query against it.

_Structure logs cater for that by saving the logs as a structured json object where all pieces are kept_. The advantage is that it provides full flexibility by allowing to query on the properties where items are typed. The other advantage is that it provides a unified way to allow multiple platform to write to their own output the logs in their own way since they get all raw propeties.

### 1.1 ASP .NET Core

Configuring Serilog with ASP .NET Core consists of three steps:

1. Download serilog aspnet core package
2. Download serilog configuration
3. Configure Serilog

For 1, we can download `Serilog.AspNetCore` and register Serilog on the WebHostBuilder in program.cs.

```
WebHost.CreateDefaultBuilder(args)
    .UseStartup<Startup>()
    .UseSerilog()
    .Build();
```

Then for 2, we can download `Serilog.Settings.Configuration` and configure Serilog to read from configuration.

```
WebHost.CreateDefaultBuilder(args)
    .UseStartup<Startup>()
    .UseSerilog((ctx, cfg) => cfg.ReadFrom.Configuration(ctx.Configuration))
    .Build();
```

This configuration gives us the ability to configure Serilog from appsettings.json
We can then configure it to write to console.


WriteTo Console


Enrich will add extra properties to the log in order to provide more information.

Sinks are the pieces in charge of sinking down the log to outputs.

In case of errors within Serilog, it is possible to debug logs from Serilog using `SelfLog`.

```
Serilog.Debugging.SelfLog.Enable(msg => Debug.WriteLine(msg));
```

## 2. Http and Rolling Files sinks